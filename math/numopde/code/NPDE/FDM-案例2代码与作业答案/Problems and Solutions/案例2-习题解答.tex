\documentclass[14pt,hyperref={CJKbookmarks=true}]{beamer}
\usepackage[space,noindent]{ctex}
\usetheme{AnnArbor}
\setbeamercolor{normal text}{bg=black!10}


\useinnertheme{rounded}

%设置被cover的内容不显示
\setbeamercovered{transparent}
\beamersetaveragebackground{black!10}
%\setbeamertemplate{theorems}[numbered]
\setbeamertemplate{footline}[frame number]
\setbeamertemplate{itemize items}[triangle]
\linespread{1.0}%行距

\begin{document}
\kaishu

\newtheorem{THeorem}{定理}
\newtheorem{DFfinition}{定义}
\newtheorem{COrollary}{\hspace{0.6cm}推论}
\newtheorem{LEmma}{引理}
\newtheorem{EXample}{例}
\newtheorem{proposition}{命题}
\newtheorem{property}{性质}
\newtheorem{remark}{注}
%\newtheorem{Remark}{注意}
\newtheorem{algorithm}{算法}

\renewcommand{\theequation}{\arabic{equation}}
\renewcommand{\theremark}{\arabic{remark}}

\title[]{第 五 章 习 题}


%\author{舒适~~彭洁}
\date{}


%\pgfdeclareimage[height=1cm]{institution-logo}{figure/rwthaachenuniversity-whitegray-eps-converted-to.pdf}

%\logo{\pgfuseimage{institution-logo}}

\frame[plain]{\titlepage}


\section{第四章习题}


\frame{

{\small
{\color{red}习题 1}~导出下列常系数线性抛物型方程初边值问题
{\footnotesize\begin{equation}\label{ex4-2.1}
\left\{ \begin{array}{ll}
   \frac{{\partial u}}{{\partial t}} = a\frac{{{\partial ^2}u}}{{\partial {x^2}}} + f(x,t),&0 < x < l,~0 < t \leqslant T \\
   u(x,0) = \phi (x),&0 < x < l\\
   u(0,t) = u(l,t) = 0,&0 \leqslant t \leqslant T
\end{array} \right.
\end{equation}}
的向后差分格式
{\footnotesize\begin{equation}\label{ex4-2.4}
\frac{{u_j^{k + 1} - u_j^k}}{\tau } = a\frac{{u_{j + 1}^{k + 1} - 2u_j^{k + 1} + u_{j - 1}^{k + 1}}}{{{h^2}}} + f_j^{k + 1}
\end{equation}}
六点对称格式
{\footnotesize\begin{equation}\label{ex4-2.5}
\frac{{u_j^{k + 1} - u_j^k}}{\tau } = \frac{a}{2}[\frac{{u_{j + 1}^{k + 1} - 2u_j^{k + 1} + u_{j - 1}^{k + 1}}}{{{h^2}}} + \frac{{u_{j + 1}^k - 2u_j^k + u_{j - 1}^k}}{{{h^2}}}] + \frac{1}{2}[f_j^{k + 1} + f_j^k]
\end{equation}}
Richardson 格式
{\footnotesize\begin{equation}\label{ex4-2.6}
\frac{{u_j^{k + 1} - u_j^{k - 1}}}{{2\tau }} = a\frac{{u_{j + 1}^k - 2u_j^k + u_{j - 1}^k}}{{{h^2}}} + f_j^k
\end{equation}}
的截断误差.
}}

\frame{

{\small
解: 首先, 计算向后差分格式的截断误差
\vskip 0.2cm
把 \eqref{ex4-2.4} 中数值解换为真解, 并左端减右端, 有
{\footnotesize\begin{eqnarray}\nonumber
R_j^k(u) &=& \frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_k})}}{\tau } - a\frac{{u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})}}{{{h^2}}} \\\label{ex4-2.7}
&&- f({x_j},{t_{k + 1}})
\end{eqnarray}}
利用 Taylor 展式, 有
{\footnotesize\begin{eqnarray}\label{ex4-2.8}
&&\frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_k})}}{\tau } = \frac{{\partial u}}{{\partial t}}({x_j},{t_k}) + O(\tau )\\\label{ex4-2.9}
&&\frac{{u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})}}{{{h^2}}}= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_{k + 1}}) + O({h^2})\\\label{ex4-2.10}
&&f({x_j},{t_{k + 1}}) = f({x_j},{t_k}) + O(\tau )
\end{eqnarray}}
}}

\frame{

{\small


把 \eqref{ex4-2.8}, \eqref{ex4-2.9} 和 \eqref{ex4-2.10} 代入 \eqref{ex4-2.7}, 并利用微分方程 \eqref{ex4-2.1}, 有
\begin{equation}\label{ex4-2.11}
   R_j^k(u) = {\left. {\left( {\frac{{\partial u}}{{\partial t}} - a\frac{{{\partial ^2}u}}{{\partial {x^2}}} - f} \right)} \right|_{({x_j},{t_k})}} + O(\tau  + {h^2})= O(\tau  + {h^2})
\end{equation}
}}

\frame{

{\small
其次, 计算六点对称格式的截断误差
\vskip 0.2cm
把 \eqref{ex4-2.5} 中数值解换为真解, 并左端减右端, 有
{\footnotesize\begin{eqnarray}\nonumber
R_j^k(u) &=& \frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_k})}}{\tau } - \frac{a}{2}( {\frac{{u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})}}{{{h^2}}}}\\\label{ex4-2.12}
&&{\frac{{u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})}}{{{h^2}}}} ) + \frac{1}{2} ( {f({x_j},{t_{k + 1}}) + f({x_j},{t_k})}  )
\end{eqnarray}}
利用 Taylor 展式，有
{\footnotesize\begin{eqnarray}\label{ex4-2.13}
   \frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_k})}}{\tau } =\frac{{\partial u}}{{\partial t}}({x_j},{t_k}) + \frac{\tau }{2}\frac{{{\partial ^2}u}}{{\partial {t^2}}}({x_j},{t_k}) + O({\tau ^2})
\end{eqnarray}}
}}

\frame{

{\small
{\footnotesize\begin{eqnarray}\nonumber
&&\frac{1}{2}( {\frac{{u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})}}{{{h^2}}}}  \\\nonumber
&&~~+ {\frac{{u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})}}{{{h^2}}}})\\\nonumber
&&=\frac{1}{2}( {\frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_{k + 1}}) + \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k})} ) + O({h^2})  \\\label{ex4-2.14}
&&= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + \frac{\tau }{2}\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k}) + O({\tau ^2}) + O({h^2})
\end{eqnarray}
\begin{eqnarray}\label{ex4-2.15}
\frac{1}{2}\left( {f({x_j},{t_{k + 1}}) + f({x_j},{t_k})} \right)=f({x_j},{t_k}) + \frac{\tau }{2}\frac{{\partial f}}{{\partial t}}({x_j},{t_k}) + O({\tau ^2})
\end{eqnarray}}
}}

\frame{

{\small
把 \eqref{ex4-2.13}, \eqref{ex4-2.14} 和 \eqref{ex4-2.15} 代入 \eqref{ex4-2.12}, 并利用微分方程 \eqref{ex4-2.1}, 有
{\footnotesize\begin{eqnarray*}\nonumber
R_j^k(u) &=& {\left. {\left( {\frac{{\partial u}}{{\partial t}} - a\frac{{{\partial ^2}u}}{{\partial {x^2}}} - f} \right)} \right|_{({x_j},{t_k})}} \\
&&+ \frac{\tau }{2}\frac{\partial }{{\partial t}}{\left. {\left( {\frac{{\partial u}}{{\partial t}} - a\frac{{{\partial ^2}u}}{{\partial {x^2}}} - f} \right)} \right|_{({x_j},{t_k})}}+ O({\tau ^2} + {h^2})\\
&=& O({\tau ^2} + {h^2})
\end{eqnarray*}}
}}

\frame{

{\small
最后, 计算 Richardson 格式的截断误差
\vskip 0.2cm
把 \eqref{ex4-2.6} 中数值解换为真解, 并左端减右端, 有
{\footnotesize\begin{eqnarray}\nonumber
% \nonumber to remove numbering (before each equation)
  R_j^k(u) &=& \frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_{k - 1}})}}{{2\tau }} - a\frac{{u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})}}{{{h^2}}} \\\label{ex4-2.17}
  && - f({x_j},{t_k})
\end{eqnarray}}
利用 Taylor 展式, 有
{\footnotesize\begin{equation}\label{ex4-2.18}
\frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_{k - 1}})}}{{2\tau }} = \frac{{\partial u}}{{\partial t}}({x_j},{t_k}) + O({\tau ^2})
\end{equation}
\begin{equation}\label{ex4-2.19}
\frac{{u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})}}{{{h^2}}} = \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + O({h^2})
\end{equation}}
}}

\frame{

{\small
把 \eqref{ex4-2.18}, \eqref{ex4-2.19} 代入 \eqref{ex4-2.17}, 并利用微分方程 \eqref{ex4-2.1}, 有
\begin{eqnarray*}
% \nonumber to remove numbering (before each equation)
  R_j^k(u) &=& {\left. {\left( {\frac{{\partial u}}{{\partial t}} - a\frac{{{\partial ^2}u}}{{\partial {x^2}}} - f} \right)} \right|_{({x_j},{t_k})}} + O({\tau ^2} + {h^2})  \\
  &=& O({\tau ^2} + {h^2})
\end{eqnarray*}
}}

\frame{

{\small
{\color{red}习题 2}~将向前差分格式和向后差分格式作加权平均, 得到如下格式:
{\footnotesize\begin{equation}\label{ex4-3.1}
\frac{{u_j^{k + 1} - u_j^k}}{\tau } = \frac{a}{{{h^2}}}\left[ {\theta \left( {u_{j + 1}^{k + 1} - 2u_j^{k + 1} + u_{j - 1}^{k + 1}} \right) + (1 - \theta )\left( {u_{j + 1}^k - 2u_j^k + u_{j - 1}^k} \right)} \right]
\end{equation}}
其中 $0 \leqslant \theta  \leqslant 1$. 试计算截断误差, 并证明当 $\theta  = \frac{1}{2} - \frac{1}{{12r}}$ 时, 截断误差的阶最高($O({\tau ^2} + {h^4})$).
\vskip 0.2cm
解: 首先, 求格式 \eqref{ex4-3.1} 的截断误差.
\vskip 0.2cm
把 \eqref{ex4-3.1} 中的数值解换为真解, 并左端减右端, 有
{\footnotesize\begin{eqnarray}\nonumber
R_j^k(u) &=& \frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_k})}}{\tau } \\\nonumber
&&- \frac{a}{{{h^2}}}[ {\theta ( {u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})} )} \\\label{ex4-3.2}
&&+ {( {1 - \theta })( {u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})})}]
\end{eqnarray}}
}}

\frame{

{\small
利用 Taylor 展式, 有
{\footnotesize\begin{eqnarray}\label{ex4-3.3}
   \frac{{u({x_j},{t_{k + 1}}) - u({x_j},{t_k})}}{\tau } =\frac{{\partial u}}{{\partial t}}({x_j},{t_k}) + \frac{\tau }{2}\frac{{{\partial ^2}u}}{{\partial {t^2}}}({x_j},{t_k}) + O({\tau ^2})
\end{eqnarray}
\begin{eqnarray}\nonumber
   &&\frac{{u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})}}{{{h^2}}}\\\nonumber
   &&= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_{k + 1}}) + \frac{{{h^4}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_{k + 1}}) + O({h^4})\\\nonumber
   &&= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_{k + 1/2}}) + \frac{\tau }{2}\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_{k + 1/2}})+ \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_{k + 1}}) + O({\tau ^2} + {h^4})\\\label{ex4-3.4}
\end{eqnarray}}
{\footnotesize\begin{eqnarray}\nonumber
   &&\frac{{u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})}}{{{h^2}}}\\\nonumber
   &&= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + \frac{{{h^4}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({h^4})\\\nonumber
   &&= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_{k + 1/2}}) - \frac{\tau }{2}\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_{k + 1/2}})+ \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})\\\label{ex4-3.5}
\end{eqnarray}}
}}



\frame{

{\small
利用 \eqref{ex4-3.4} 和 \eqref{ex4-3.5}, 有
{\footnotesize\begin{eqnarray}\nonumber
   &&\frac{1}{{{h^2}}}\left[ {\theta \left( {u({x_{j + 1}},{t_{k + 1}}) - 2u({x_j},{t_{k + 1}}) + u({x_{j - 1}},{t_{k + 1}})} \right)} \right.\\\nonumber
   &&~~~~ + \left. {\left( {1 - \theta } \right)\left( {u({x_{j + 1}},{t_k}) - 2u({x_j},{t_k}) + u({x_{j - 1}},{t_k})} \right)} \right]\\\nonumber
   && = \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_{k + 1/2}}) + \left( {2\theta  - 1} \right)\frac{\tau }{2}\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_{k + 1/2}})\\\nonumber
   &&~~~~+ \theta \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_{k + 1}}) + \left( {1 - \theta } \right)\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})\\\nonumber
   && = \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + \frac{\tau }{2}\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k}) + \left( {2\theta  - 1} \right)\frac{\tau }{2}\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k})\\\nonumber
   &&~~~~ + \theta \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_{k + 1}}) + \left( {1 - \theta } \right)\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})\\\nonumber
   && = \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + \theta \tau \frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k})\\\nonumber
   &&~~~~ + \theta \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_{k + 1}}) + \left( {1 - \theta } \right)\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})
   \end{eqnarray}}
}}


\frame{

{\small
{\footnotesize\begin{eqnarray}\nonumber
   &&= \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + \theta \tau \frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k})\\\nonumber
   &&~~~~ + \theta \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_{k}}) + \left( {1 - \theta } \right)\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})\\\nonumber
   && = \frac{{{\partial ^2}u}}{{\partial {x^2}}}({x_j},{t_k}) + \theta \tau \frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k})\\\label{ex4-3.6}
   &&~~~~ + \frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})
\end{eqnarray}}
}}

\frame{

{\small
把 \eqref{ex4-3.3} 和 \eqref{ex4-3.6} 代入 \eqref{ex4-3.2}, 并利用该差分格式所对应的微分方程, 有
{\footnotesize\begin{eqnarray}\nonumber
R_j^k &=& {\left. {\left( {\frac{{\partial u}}{{\partial t}} - a\frac{{{\partial ^2}u}}{{\partial {x^2}}}} \right)} \right|_{({x_j},{t_k})}} + \frac{\tau }{2}\frac{\partial }{{\partial t}}{\left. {\left( {\frac{{\partial u}}{{\partial t}} - a\frac{{{\partial ^2}u}}{{\partial {x^2}}}} \right)} \right|_{({x_j},{t_k})}}\\\nonumber
 &&- a\tau (\theta  - \frac{1}{2})\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k}) - a\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})\\\nonumber
& = & - a\tau (\theta  - \frac{1}{2})\frac{{{\partial ^3}u}}{{\partial t\partial {x^2}}}({x_j},{t_k}) - a\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})\\\nonumber
& =& \left[ { - a^2\tau (\theta  - \frac{1}{2})\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) - a\frac{{{h^2}}}{{12}}\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k})} \right] + O({\tau ^2} + {h^4})\\\label{ex4-3.7}
& =& a\left[ { - a\tau (\theta  - \frac{1}{2}) - \frac{{{h^2}}}{{12}}} \right]\frac{{{\partial ^4}u}}{{\partial {x^4}}}({x_j},{t_k}) + O({\tau ^2} + {h^4})
\end{eqnarray}}
当 $a\tau (\theta  - \frac{1}{2}) =  - \frac{{{h^2}}}{{12}}$ 时，即 $\theta  = \frac{1}{2} - \frac{1}{{12r}}$,  \eqref{ex4-3.7} 的截断误差的阶最高, 且为$O({\tau ^2} + {h^4})$.
}}

\frame{

{\small

{\color{red}习题 3}~用判别稳定性的{\color{blue}直接估计法(矩阵法)}, 求证差分格式
{\footnotesize\begin{equation}\label{ex4-3.1}
\frac{{u_j^{k + 1} - u_j^k}}{\tau } = \frac{a}{{{h^2}}}\left[ {\theta \left( {u_{j + 1}^{k + 1} - 2u_j^{k + 1} + u_{j - 1}^{k + 1}} \right) + (1 - \theta )\left( {u_{j + 1}^k - 2u_j^k + u_{j - 1}^k} \right)} \right]
\end{equation}}
当 $\frac{1}{2} \leqslant \theta  \leqslant 1$ 恒稳定, 当 $0 \leqslant \theta  < \frac{1}{2}$ 时, 稳定的充要条件是
$$r \leqslant \frac{1}{{2(1 - 2\theta )}}.$$

证明: {\color{blue}Step 1: 写出差分格式的矩阵表示.}
\vskip 0.2cm
\eqref{ex4-3.1}{\footnotesize$ \Leftrightarrow $
$$u_j^{k + 1} - u_j^k = r\left[ {\theta \left( {u_{j + 1}^{k + 1} - 2u_j^{k + 1} + u_{j - 1}^{k + 1}} \right) + (1 - \theta )\left( {u_{j + 1}^k - 2u_j^k + u_{j - 1}^k} \right)} \right]$$
$ \Leftrightarrow $
$$(1 + 2\theta r)u_j^{k + 1} - \theta r\left( {u_{j + 1}^{k + 1} + u_{j - 1}^{k + 1}} \right) = \left( {1 - 2(1 - \theta )r} \right)u_j^k + (1 - \theta )r\left( {u_{j + 1}^k + u_{j - 1}^k} \right)$$}
}}

\frame{

{\small
{\footnotesize$ \Leftrightarrow $
$$\left[ {(1 + 2\theta r)\rm I - \theta rS} \right]{U^{k + 1}}= \left[ {\left( {1 - 2(1 - \theta )r} \right)\rm I + (1 - \theta )rS} \right]{U^k}$$}
其中 $\rm I$ 为 $N-1$ 阶的单位矩阵, ${U^k} = {(u_1^k,u_2^k, \cdots ,u_{N - 1}^k)^T}$
{\footnotesize$$S = {\left( \begin{array}{ccccc}
   0 & 1 & {} & {} & {}  \\
   1 & 0 &  \ddots  & {} & {}  \\
   {} &  \ddots  &  \ddots  &  \ddots  & {}  \\
   {} & {} &  \ddots  & 0 & 1  \\
   {} & {} & {} & 1 & 0
 \end{array} \right)_{(N - 1) \times (N - 1)}}$$
 $ \Leftrightarrow $
 $${U^{k + 1}} = C{U^k}$$}
其中
{\footnotesize$$C = {\left[ {(1 + 2\theta r)\rm I - \theta rS} \right]^{ - 1}}\left[ {\left( {1 - 2(1 - \theta )r} \right)\rm I + (1 - \theta )rS} \right]$$}
{\color{blue}Step 2: 判别差分格式的稳定性.}\vskip 0.2cm

$S$ 的特征值为
{\footnotesize$$\lambda _j^S = 2\cos j\pi h,{\text{    }}j = 1,2, \cdots ,N - 1;~h = \frac{1}{N}$$}
}}

\frame{

{\small
又注意到该差分格式所对应的矩阵 $C$ 是对称矩阵 $S$ 的实系数有理函数, 因此其特征值为
{\footnotesize\begin{eqnarray*}
   \lambda _j^C &=& \frac{{\left( {1 - 2(1 - \theta )r} \right) + (1 - \theta )r2\cos j\pi h}}{{(1 + 2\theta r) - \theta r2\cos j\pi h}}  \\
                &=& \frac{{1 - 2(1 - \theta )r(1 - \cos j\pi h)}}{{1 + 2\theta r(1 - \cos j\pi h)}}  \\
  &=& \frac{{1 - 4(1 - \theta )r{{\sin }^2}\frac{{j\pi h}}{2}}}{{1 + 4\theta r{{\sin }^2}\frac{{j\pi h}}{2}}},~j = 1,2, \cdots ,N - 1;~h = \frac{1}{N}
\end{eqnarray*}}
因此, 由 pp.171 推论 5.2.1 知:  差分格式 \eqref{ex4-3.1} 稳定的充要条件是 (对一切 $0
< \tau \le \tau _0$)
{\footnotesize\begin{eqnarray*}\nonumber
&&\left| {\lambda _j^C} \right| \leqslant 1 + M\tau,~~~j = 1,\cdots,N - 1
\\\nonumber  \Leftrightarrow && \left| {\frac{{1 - 4(1 - \theta )r{{\sin }^2}\frac{{j\pi h}}{2}}}{{1 + 4\theta r{{\sin }^2}\frac{{j\pi h}}{2}}}} \right| \leqslant 1 + M\tau
\\\nonumber \Leftrightarrow && - 1 - M\tau  \leqslant \frac{{1 - 4(1 - \theta )r{{\sin }^2}\frac{{j\pi h}}{2}}}{{1 + 4\theta r{{\sin }^2}\frac{{j\pi h}}{2}}} \leqslant 1 + M\tau
\end{eqnarray*}}

}}

\frame{

{\small
{\footnotesize\begin{eqnarray*}\nonumber
\Leftrightarrow &&- 1 \leqslant \frac{{1 - 4(1 - \theta )r{{\sin }^2}\frac{{j\pi h}}{2}}}{{1 + 4\theta r{{\sin }^2}\frac{{j\pi h}}{2}}} \leqslant 1
\end{eqnarray*}}
上式右侧的不等式显然对任意的 $0 \leqslant \theta  \leqslant 1$ 及 $r > 0$ 均成立. 故只需要考查左侧的不等式
{\footnotesize\begin{eqnarray}\nonumber
&& - 1 - 4\theta r{\sin ^2}\frac{{j\pi h}}{2} \leqslant 1 - 4(1 - \theta )r{\sin ^2}\frac{{j\pi h}}{2}\\\nonumber
\Leftrightarrow && - 4(1 - \theta )r{\sin ^2}\frac{{j\pi h}}{2} + 4\theta r{\sin ^2}\frac{{j\pi h}}{2} \geqslant  - 1-1\\\nonumber
\Leftrightarrow && - 4(1 - 2\theta )r{\sin ^2}\frac{{j\pi h}}{2}\geqslant  - 2\\\label{*}
\Leftrightarrow && 2(2\theta  - 1)r{\sin ^2}\frac{{j\pi h}}{2} \geqslant  - 1
\end{eqnarray}}
若 $2\theta  - 1 \geqslant 0$, 即 $\frac{1}{2} \leqslant \theta  < 1$, 上式恒成立, 所以差分格式 \eqref{ex4-3.1} 恒稳定.


}}

\frame{

{\small
若 $2\theta  - 1 < 0$, 即 $0 \leqslant \theta  < \frac{1}{2}$, \eqref{*} 等价于
$$2(1 - 2\theta )r{\sin ^2}\frac{{j\pi h}}{2} \leqslant 1,~~j = 1,2, \cdots ,N - 1;~h = \frac{1}{N}$$
$ \Leftrightarrow $
$$r \leqslant \frac{1}{{2(1 - 2\theta )}}$$
即 $0 \leqslant \theta  < \frac{1}{2}$, 格式 \eqref{ex4-4.1} 稳定的充要条件是
$$r \leqslant \frac{1}{{2(1 - 2\theta )}}$$\qed
}}

\frame{

{\small
{\color{red}习题 4}~用 {\color{blue} Fourier 方法}证明差分格式
{\footnotesize\begin{equation}\label{ex4-4.1}
\frac{{u_j^{k + 1} - u_j^k}}{\tau } = \frac{a}{{{h^2}}}\left[ {\theta \left( {u_{j + 1}^{k + 1} - 2u_j^{k + 1} + u_{j - 1}^{k + 1}} \right) + (1 - \theta )\left( {u_{j + 1}^k - 2u_j^k + u_{j - 1}^k} \right)} \right]
\end{equation}}
稳定的充要条件 ($r=a\frac{\tau}{h^2}$)
{\footnotesize$$r \leqslant \frac{1}{{2(1 - 2\theta )}},~~{0 \leqslant \theta  < \frac{1}{2}}$$}
证明:
\vskip 0.2cm
\eqref{ex4-4.1}$ \Leftrightarrow $
{\footnotesize\begin{eqnarray}\nonumber
&&(1 + 2\theta r)u_j^{k + 1} - \theta r\left( {u_{j + 1}^{k + 1} + u_{j - 1}^{k + 1}} \right)\\\label{ex4-4.2}
&& = \left( {1 - 2(1 - \theta )r} \right)u_j^k + (1 - \theta )r\left( {u_{j + 1}^k + u_{j - 1}^k} \right)
\end{eqnarray}}
取通项
{\footnotesize\begin{equation}\label{ex4-4.3}
u_{j + m}^{k + q} = {v_{k + q}}{e^{i\alpha ({x_j} + mh)}},~ \alpha
= 2p\pi
\end{equation}}
}}

\frame{

{\small

将 \eqref{ex4-4.3} 代入 \eqref{ex4-4.2}, 有
{\footnotesize\begin{eqnarray*}
&&{v^{k + 1}}e^{i\alpha x_j}\left[ {(1 + 2\theta r) - \theta r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]\\
&& = {v^k}e^{i\alpha x_j}\left[ {\left( {1 - 2(1 - \theta )r} \right) - (1 - \theta )r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]
\end{eqnarray*}}
消去 $e^{i\alpha x_j}$,
$\Leftrightarrow$
{\footnotesize\begin{eqnarray*}
&&{v^{k + 1}}\left[ {(1 + 2\theta r) - \theta r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]\\
&& = {v^k}\left[ {\left( {1 - 2(1 - \theta )r} \right) - (1 - \theta )r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]
\end{eqnarray*}}
$\Leftrightarrow$
{\footnotesize\begin{eqnarray*}
&&{v^{k + 1}}= {v^k}\left[ {(1 + 2\theta r) - \theta r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]^{-1}\\
&&~~~~~~~~~\left[ {\left( {1 - 2(1 - \theta )r} \right) - (1 - \theta )r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]
\end{eqnarray*}}
}}

\frame{

{\small
由此可知, 增长因子为
{\footnotesize\begin{eqnarray*}
G(ph,\tau ) &=& {\left[ {(1 + 2\theta r) - \theta r\left( {e^{i\alpha h} + e^{- i\alpha h}} \right)} \right]^{ - 1}}  \\
&&\times\left[ {\left( {1 - 2(1 - \theta )r} \right) - (1 - \theta )r\left( {e^{i\alpha h} + e^{ - i\alpha h}} \right)} \right]\\
&=& \frac{{\left( {1 - 2(1 - \theta )r} \right) - 2(1 - \theta )r\cos \alpha h}}{{(1 + 2\theta r) - 2\theta r\cos \alpha h}}\\
&=& \frac{{1 - 4(1 - \theta )r{{\sin }^2}\frac{{\alpha h}}{2}}}{{1 + 4\theta r{{\sin }^2}\frac{{\alpha h}}{2}}}
\end{eqnarray*}}
}}

\frame{

{\small
由 Von Neumann 条件可知, 格式 \eqref{ex4-4.1} 稳定的充分条件是
{\footnotesize$$\left| {\frac{{1 - 4(1 - \theta )r{{\sin }^2}\frac{{\alpha h}}{2}}}{{1 + 4\theta r{{\sin }^2}\frac{{\alpha h}}{2}}}} \right| \leqslant 1 + M\tau $$}
剩下的证明过程与习题 3 完全一样, 即 $0 \leqslant \theta  < \frac{1}{2}$, 格式 \eqref{ex4-4.1} 稳定的充要条件是
$$r \leqslant \frac{1}{{2(1 - 2\theta )}}$$\qed
}}

\frame{

{\small
{\color{red}习题 5}~证明差分格式
{\footnotesize\begin{equation}\label{ex4-5.1}
\frac{{u_j^{k + 1} - u_j^k}}{\tau } = a\frac{{u_{j + 1}^k - 2u_j^k + u_{j - 1}^k}}{{{h^2}}} + b\frac{{u_{j + 1}^k - u_{j - 1}^k}}{{2h}} + cu_j^k
\end{equation}}
稳定的充要条件是网比 $r = a\frac{\tau }{{{h^2}}} \leqslant \frac{1}{2}$, 其中 $a > 0, b, c$ 有界.\vskip 0.2cm

证明:  \vskip 0.2cm

\eqref{ex4-5.1}$\Leftrightarrow$
{\footnotesize$$u_j^{k + 1} - u_j^k = r\left( {u_{j + 1}^k - 2u_j^k + u_{j - 1}^k} \right) + \frac{{b\tau }}{{2h}}\left( {u_{j + 1}^k - u_{j - 1}^k} \right) + c\tau u_j^k$$
$\Leftrightarrow$
\begin{equation}\label{ex4-5.2}
u_j^{k + 1} = \left( {r + \frac{{b\tau }}{{2h}}} \right)u_{j + 1}^k + \left( {1 - 2r + c\tau } \right)u_j^k + \left( {r - \frac{{b\tau }}{{2h}}} \right)u_{j - 1}^k
\end{equation}}
取通项
{\footnotesize\begin{equation}\label{ex4-5.3}
u_{j + m}^{k + q} = {v_{k + q}}{e^{i\alpha ({x_j} + mh)}},~ \alpha
= 2p\pi
\end{equation}}
}}

\frame{

{\small

将 \eqref{ex4-5.3} 代入 \eqref{ex4-5.2}, 有
{\footnotesize\begin{eqnarray*}
{v^{k + 1}}e^{i\alpha x_j}={v^k}e^{i\alpha x_j}\left[ {\left( {r + \frac{{b\tau }}{{2h}}} \right)e^{i\alpha h}} + {\left( {1 - 2r + c\tau } \right) + \left( {r - \frac{{b\tau }}{{2h}}} \right)e^{- i\alpha h}} \right]
\end{eqnarray*}}
消去 $e^{i\alpha x_j}$, $\Leftrightarrow$
{\footnotesize\begin{eqnarray*}
{v^{k + 1}}={v^k}\left[ {\left( {r + \frac{{b\tau }}{{2h}}} \right)e^{i\alpha h}} + {\left( {1 - 2r + c\tau } \right) + \left( {r - \frac{{b\tau }}{{2h}}} \right)e^{- i\alpha h}} \right]
\end{eqnarray*}}
由此可得, 增长因子为
{\footnotesize\begin{eqnarray*}
G(ph,\tau ) &=& \left( {r + \frac{{b\tau }}{{2h}}} \right)e^{i\alpha h} + \left( {1 - 2r + c\tau } \right) + \left( {r - \frac{{b\tau }}{{2h}}} \right)e^{- i\alpha h}\\
 &=& r\left[ {e^{i\alpha h} + e^{ - i\alpha h}} \right] + \left( {1 - 2r + c\tau } \right) \\
 &&+ \frac{{b\tau }}{{2h}}\left[ {e^{i\alpha h} - e^{- i\alpha h}} \right]\\
 & =& 2r\cos \alpha h + \left( {1 - 2r + c\tau } \right) + \frac{{b\tau }}{{2h}}\sin \alpha h\\
 & =& 1 - 4r{\sin ^2}\frac{{\alpha h}}{2} + \frac{{b\tau }}{{2h}}\sin \alpha h + c\tau
\end{eqnarray*}}
}}


\frame{

{\small 由 Von Neumann 条件可知 (可以证明  Von Neumann 条件可改写为
$|G(ph,\tau )|\le 1+O(\tau^{1/2})$), 格式 \eqref{ex4-5.1}
稳定的充分条件是 {\footnotesize$$\left| {1 - 4r{{\sin
}^2}\frac{{\alpha h}}{2} + \frac{{b\tau }}{{2h}}\sin \alpha h +
c\tau } \right| \leqslant 1 + M\tau^{1/2} $$ $ \Leftrightarrow $
\begin{equation}\label{ex4-5.4}
 - 1 - M\tau^{1/2}  \leqslant 1 - 4r{\sin ^2}\frac{{\alpha h}}{2} + (c + \frac{b}{2h}\sin\alpha h)\tau  \leqslant 1 + M\tau^{1/2}
\end{equation}}
\eqref{ex4-5.4} 右侧不等式显然对任意的 $r > 0$ 恒成立. 而
\eqref{ex4-5.4} 左侧不等式等价于 {\footnotesize$$ - 1 + 4r{\sin
^2}\frac{{\alpha h}}{2} -(c+ \frac{b}{2h}\sin\alpha h)\tau \leqslant
1 + M\tau^{1/2} $$} $ \Leftrightarrow $ (注意
$\frac{b}{2h}(\sin\alpha h)
\tau=O(\frac{\tau}{h})=O(h)=O(\tau^{1/2})$ (因为
$r=\frac{\tau}{h^2}$ 是常数))

{\footnotesize$$ - 1 + 4r{\sin ^2}\frac{{\alpha h}}{2} \leqslant 1 ~
\Leftrightarrow ~ 4r{\sin ^2}\frac{{\alpha h}}{2} \leqslant 2  $$} $
\Leftrightarrow $ {\footnotesize$$ 4r \leqslant 2
~~~~\Leftrightarrow~~~~r \leqslant \frac{1}{2}  $$} \qed }}



\frame{

{\small
{\color{red}习题 $1^*$}~求
$$S=\left(\begin{array}{ccccc}0&1&\cdots&0&0\\
1&0&\cdots&0&0\\
\vdots&\vdots& &\vdots&\vdots\\
0&0&\cdots&0&1\\
0&0&\cdots&1&0\end{array}\right)_{(N-1)\times(N-1)}$$
的特征值和特征向量. \vskip 0.2cm 解：记 $\lambda$ 为矩阵 $S$
的任意特征值, $u=(u_1,\cdots,u_{N-1})^{T}$ 为 $\lambda$ 非平凡
(或非零) 特征向量. 由特征值和特征向量的定义知: $\lambda$ 及 $u$ 满足
$$Su=\lambda u$$
$\Leftrightarrow$ 差分方程
\begin{equation}\label{ex4.1.0}
\left\{\begin{array}{l}
l_hu:=u_{j-1}+u_{j+1}=\lambda u_j,~j=1,\cdots,N-1\\
u_0=u_N=0\end{array}\right.
\end{equation}

}}

\frame{

{\small 由盖尔圆盘定理可知, $|\lambda|\le 2$, 故可令
\begin{equation}\label{ex4.1.1}
\lambda=2\cos\theta,~~\theta\in[0, \pi]
\end{equation}
则此时 \eqref{ex4.1.0} 可等价的表示为
\begin{eqnarray}\label{ex4.1.2}
%\left\{\begin{array}{l}
&&l_hu:=u_{j-1}+u_{j+1}=2\cos\theta u_j,~j=1,\cdots,N-1\\\label{ex4.1.3}
&&u_0=u_N=0
%\end{array}\right.
\end{eqnarray}
%将 \eqref{ex4.2} (或 \eqref{ex4.1}) 的通解 $u_j=z^j(z\neq 0)$
%代入上述方程组, 则有
%$$\left\{\begin{array}{l}
%z^{j-1}+z^{j+1}=2\cos\theta z^j,~j=1,\cdots,N-1\\
%z^0=z^N=0\end{array}\right.$$
%因为 $z\neq 0$, 所以上式可等价为
下面先给出二阶齐次线性差分方程 \eqref{ex4.1.2} 的通解序列 (向量)
表示, 其关键是求出 \eqref{ex4.1.2} 的两个线性无关的特解序列. 为此,
令
$$u_j=z^j, j=0,1,\cdots, N$$ 其中 $z$ 是待定(复)常数, 将它代人
\eqref{ex4.1.2}, 有
$$
z^{2}-2\cos\theta z+1=0
$$

}}

\frame{

{\small 上述一元二次方程有两个根
$$z_1=e^{i\theta},~~z_2=e^{-i\theta}$$
由此就得到了 \eqref{ex4.1.2} 的两个线性无关的解序列
%而 $u_j=z^j$, 所以
$$u_j^{(1)}=e^{ij\theta},~~u_j^{(2)}=e^{-ij\theta}, j=0,1,\cdots, N$$
又由齐次线性差分方程解的理论知: 方程 \eqref{ex4.1.2}
的任意两个线性无关解序列的线性组合仍然是 \eqref{ex4.1.2} 的解, 因此
$$\frac{u_j^{(1)}+u_j^{(2)}}{2}=\cos
j\theta,~\frac{u_j^{(1)}-u_j^{(2)}}{2i}=\sin j\theta,  j=0,1,\cdots,
N$$ 也构成了\eqref{ex4.1.2} 的两个线性无关的解序列.

利用这两个线性无关的解序列 $\{\cos j\theta\}$ 和 $\{\sin j\theta\}$
可知: 差分方程 \eqref{ex4.1.2} 的通解序列可表示为
$$a\cos j\theta+b\sin j\theta$$
其中 $a$ 和 $b$ 为任意实常数. }}

\frame{

{\small 接着利用边值条件  \eqref{ex4.1.3} 确定上述通解中的系数 $a$
和 $b$.

首先由边值条件 $u_0=0$, 有
$$u_0=a\cos 0+b\sin 0$$
故 $a=0$.

又注意 $u$ 为  $\lambda$ 的非平凡 (或非零) 特征向量,  所以常数
$b\neq 0$, 不妨取 $b=1$ (因为特征向量乘以任意非零常数还是特征向量),

综上知: $\lambda$ 的非平凡特征向量$u$ 的分量可表示为
\begin{equation}\label{ex4.1.4}
u_j=\sin j\theta,~~j=0,\cdots,N
\end{equation}
下面确定待定系数 $\theta$. 由边值条件 $u_N=0$, 可得  $\theta$ 满足
\begin{equation}\label{ex4.1.4-00}
\sin N \theta=0\end{equation}
 由此并注意 $\theta\in (0,\pi)$ (非平凡解要求
$\theta \neq 0 \mbox{或} \pi$) 可知: 有 $N-1$ 个  $\theta$ 值:
\begin{equation}\label{ex4.1.5}
\theta_k=\frac{k\pi}{N},~k=1,\cdots, N-1
\end{equation}
满足 \eqref{ex4.1.4-00}. }}

\frame{

{\small
利用 \eqref{ex4.1.1}, 以及 \eqref{ex4.1.5} 和 \eqref{ex4.1.4} 可得 $N-1$ 个特征值%(利用三角函数的周期性)
$$\lambda_k=2\cos \frac{k\pi}{N}, ~~k=1,2,\cdots,N-1$$
和 $\lambda_k$ 相应的特征向量 (均对应 $\theta_k$)
$$u=\left\{\sin \frac{jk\pi}{N}\right\}_{j=1}^{N-1},~~k=1,2,\cdots,N-1.$$\qed
}}



\end{document}
